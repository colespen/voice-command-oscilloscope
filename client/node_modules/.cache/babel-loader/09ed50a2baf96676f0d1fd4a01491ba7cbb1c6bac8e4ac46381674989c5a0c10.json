{"ast":null,"code":"let canvasWidth, canvasHeight, bufferLength, dataArray, sliceWidth;\nonmessage = function (e) {\n  switch (e.data.type) {\n    case \"init\":\n      const {\n        canvasWidth: width,\n        canvasHeight: height,\n        bufferLen\n      } = e.data.payload;\n      canvasWidth = width;\n      canvasHeight = height;\n      bufferLength = bufferLen;\n      dataArray = new Float32Array(bufferLength);\n      sliceWidth = canvasWidth * 1.0 / bufferLength;\n      break;\n    case \"draw\":\n      draw(e.data.payload);\n      break;\n    default:\n      break;\n  }\n};\nfunction draw(data) {\n  const {\n    canvas,\n    ctx,\n    analyser\n  } = data;\n  if (!ctx) {\n    return;\n  }\n  analyser.getFloatTimeDomainData(dataArray);\n  ctx.fillStyle = \"black\";\n  ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n  ctx.lineWidth = 2;\n  ctx.strokeStyle = \"green\";\n  ctx.beginPath();\n  let x = 0;\n  let y = canvasHeight / 2;\n  for (let i = 0; i < bufferLength; i++) {\n    const v = dataArray[i];\n    const val = v * 0.5;\n    const yOffset = val * canvasHeight;\n    y = canvasHeight / 2 + yOffset;\n    if (i === 0) {\n      ctx.moveTo(x, y);\n    } else {\n      ctx.lineTo(x, y);\n    }\n    x += sliceWidth;\n  }\n  ctx.stroke();\n  postMessage(\"draw\");\n}\nexport {};","map":{"version":3,"names":["canvasWidth","canvasHeight","bufferLength","dataArray","sliceWidth","onmessage","e","data","type","width","height","bufferLen","payload","Float32Array","draw","canvas","ctx","analyser","getFloatTimeDomainData","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","x","y","i","v","val","yOffset","moveTo","lineTo","stroke","postMessage"],"sources":["/Users/beluga/Documents/Dev/React/audio_visualizer/src/worker/drawer.ts"],"sourcesContent":["let canvasWidth: number, canvasHeight: number, bufferLength: number, dataArray: number[], sliceWidth: number;\n\nonmessage = function (e: MessageEvent<string>) {\n  switch (e.data.type) {\n    case \"init\":\n      const { canvasWidth: width, canvasHeight: height, bufferLen } = e.data.payload;\n      canvasWidth = width;\n      canvasHeight = height;\n      bufferLength = bufferLen;\n      dataArray = new Float32Array(bufferLength);\n      sliceWidth = canvasWidth * 1.0 / bufferLength;\n      break;\n\n    case \"draw\":\n      draw(e.data.payload);\n      break;\n\n    default:\n      break;\n  }\n};\n\nfunction draw(data) {\n  const { canvas, ctx, analyser } = data;\n\n  if (!ctx) {\n    return;\n  }\n\n  analyser.getFloatTimeDomainData(dataArray);\n\n  ctx.fillStyle = \"black\";\n  ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n  ctx.lineWidth = 2;\n  ctx.strokeStyle = \"green\";\n\n  ctx.beginPath();\n\n  let x = 0;\n  let y = canvasHeight / 2;\n\n  for (let i = 0; i < bufferLength; i++) {\n    const v = dataArray[i];\n    const val = v * 0.5;\n    const yOffset = val * canvasHeight;\n    y = canvasHeight / 2 + yOffset;\n\n    if (i === 0) {\n      ctx.moveTo(x, y);\n    } else {\n      ctx.lineTo(x, y);\n    }\n\n    x += sliceWidth;\n  }\n\n  ctx.stroke();\n\n  postMessage(\"draw\");\n}\n\nexport {}"],"mappings":"AAAA,IAAIA,WAAmB,EAAEC,YAAoB,EAAEC,YAAoB,EAAEC,SAAmB,EAAEC,UAAkB;AAE5GC,SAAS,GAAG,SAAAA,CAAUC,CAAuB,EAAE;EAC7C,QAAQA,CAAC,CAACC,IAAI,CAACC,IAAI;IACjB,KAAK,MAAM;MACT,MAAM;QAAER,WAAW,EAAES,KAAK;QAAER,YAAY,EAAES,MAAM;QAAEC;MAAU,CAAC,GAAGL,CAAC,CAACC,IAAI,CAACK,OAAO;MAC9EZ,WAAW,GAAGS,KAAK;MACnBR,YAAY,GAAGS,MAAM;MACrBR,YAAY,GAAGS,SAAS;MACxBR,SAAS,GAAG,IAAIU,YAAY,CAACX,YAAY,CAAC;MAC1CE,UAAU,GAAGJ,WAAW,GAAG,GAAG,GAAGE,YAAY;MAC7C;IAEF,KAAK,MAAM;MACTY,IAAI,CAACR,CAAC,CAACC,IAAI,CAACK,OAAO,CAAC;MACpB;IAEF;MACE;EAAM;AAEZ,CAAC;AAED,SAASE,IAAIA,CAACP,IAAI,EAAE;EAClB,MAAM;IAAEQ,MAAM;IAAEC,GAAG;IAAEC;EAAS,CAAC,GAAGV,IAAI;EAEtC,IAAI,CAACS,GAAG,EAAE;IACR;EACF;EAEAC,QAAQ,CAACC,sBAAsB,CAACf,SAAS,CAAC;EAE1Ca,GAAG,CAACG,SAAS,GAAG,OAAO;EACvBH,GAAG,CAACI,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAEpB,WAAW,EAAEC,YAAY,CAAC;EAE7Ce,GAAG,CAACK,SAAS,GAAG,CAAC;EACjBL,GAAG,CAACM,WAAW,GAAG,OAAO;EAEzBN,GAAG,CAACO,SAAS,EAAE;EAEf,IAAIC,CAAC,GAAG,CAAC;EACT,IAAIC,CAAC,GAAGxB,YAAY,GAAG,CAAC;EAExB,KAAK,IAAIyB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxB,YAAY,EAAEwB,CAAC,EAAE,EAAE;IACrC,MAAMC,CAAC,GAAGxB,SAAS,CAACuB,CAAC,CAAC;IACtB,MAAME,GAAG,GAAGD,CAAC,GAAG,GAAG;IACnB,MAAME,OAAO,GAAGD,GAAG,GAAG3B,YAAY;IAClCwB,CAAC,GAAGxB,YAAY,GAAG,CAAC,GAAG4B,OAAO;IAE9B,IAAIH,CAAC,KAAK,CAAC,EAAE;MACXV,GAAG,CAACc,MAAM,CAACN,CAAC,EAAEC,CAAC,CAAC;IAClB,CAAC,MAAM;MACLT,GAAG,CAACe,MAAM,CAACP,CAAC,EAAEC,CAAC,CAAC;IAClB;IAEAD,CAAC,IAAIpB,UAAU;EACjB;EAEAY,GAAG,CAACgB,MAAM,EAAE;EAEZC,WAAW,CAAC,MAAM,CAAC;AACrB;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}