{"ast":null,"code":"const socket = io();\nconst SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\nconst recognition = new SpeechRecognition();\n// const startButton = document.querySelector(\"button\");\n// const microphone = document.querySelector(\".fa-microphone\");\n// const output = document.querySelector(\".output\");\n// const loading = document.querySelector(\".lds-ripple\");\n\nrecognition.lang = \"en-US\";\nrecognition.interimResults = false;\nrecognition.continuous = true;\nlet listening = false;\nexport const start = () => {\n  botSpeak(\"Yo! What is good?!\");\n  recognition.start();\n  output.textContent = \"Listening ... \";\n  loading.classList.add(\"reveal\");\n  microphone.classList.add(\"hide\");\n};\nexport const stop = () => {\n  recognition.stop();\n  botSpeak(\"Thanks for dropping by!\");\n  output.textContent = \"Session ended\";\n  loading.classList.remove(\"reveal\");\n  microphone.classList.remove(\"hide\");\n};\nstartButton.addEventListener(\"click\", () => {\n  listening ? stop() : start();\n  listening = !listening;\n});\nrecognition.addEventListener(\"result\", e => {\n  //console.log(e.results); // e.results :SpeechRecognitionResult object\n  const last = e.results.length - 1;\n  const text = e.results[last][0].transcript;\n  socket.emit(\"user message\", text);\n});\nrecognition.addEventListener(\"speechend\", () => {\n  listening ? stop() : null;\n  listening = !listening;\n});\nrecognition.addEventListener(\"error\", e => {\n  console.log(e.error);\n  stop();\n});\n\n// receive message from server\nconst botSpeak = (text, callback) => {\n  const synth = window.speechSynthesis;\n  const utterance = new SpeechSynthesisUtterance(text);\n  synth.speak(utterance);\n  utterance.onend = () => {\n    if (typeof callback === \"function\") {\n      callback();\n    }\n  };\n};\nsocket.on(\"bot message\", answer => {\n  const {\n    msg,\n    link\n  } = answer;\n  botSpeak(msg);\n  if (link) {\n    window.open(link, \"_blank\");\n  }\n});","map":{"version":3,"names":["socket","io","SpeechRecognition","window","webkitSpeechRecognition","recognition","lang","interimResults","continuous","listening","start","botSpeak","output","textContent","loading","classList","add","microphone","stop","remove","startButton","addEventListener","e","last","results","length","text","transcript","emit","console","log","error","callback","synth","speechSynthesis","utterance","SpeechSynthesisUtterance","speak","onend","on","answer","msg","link","open"],"sources":["/Users/beluga/Documents/Dev/React/audio_visualizer/client/src/util/speechRecognition.js"],"sourcesContent":["const socket = io();\nconst SpeechRecognition =\n  window.SpeechRecognition || window.webkitSpeechRecognition;\nconst recognition = new SpeechRecognition();\n// const startButton = document.querySelector(\"button\");\n// const microphone = document.querySelector(\".fa-microphone\");\n// const output = document.querySelector(\".output\");\n// const loading = document.querySelector(\".lds-ripple\");\n\nrecognition.lang = \"en-US\";\nrecognition.interimResults = false;\nrecognition.continuous = true;\nlet listening = false;\n\nexport const start = () => {\n  botSpeak(\"Yo! What is good?!\");\n  recognition.start();\n  output.textContent = \"Listening ... \";\n  loading.classList.add(\"reveal\");\n  microphone.classList.add(\"hide\");\n};\n\nexport const stop = () => {\n  recognition.stop();\n  botSpeak(\"Thanks for dropping by!\");\n  output.textContent = \"Session ended\";\n  loading.classList.remove(\"reveal\");\n  microphone.classList.remove(\"hide\");\n};\n\nstartButton.addEventListener(\"click\", () => {\n  listening ? stop() : start();\n  listening = !listening;\n});\n\nrecognition.addEventListener(\"result\", (e) => {\n  //console.log(e.results); // e.results :SpeechRecognitionResult object\n  const last = e.results.length - 1;\n  const text = e.results[last][0].transcript;\n  socket.emit(\"user message\", text);\n});\n\nrecognition.addEventListener(\"speechend\", () => {\n  listening ? stop() : null;\n  listening = !listening;\n});\n\nrecognition.addEventListener(\"error\", (e) => {\n  console.log(e.error);\n  stop();\n});\n\n// receive message from server\nconst botSpeak = (text, callback) => {\n  const synth = window.speechSynthesis;\n  const utterance = new SpeechSynthesisUtterance(text);\n  synth.speak(utterance);\n\n  utterance.onend = () => {\n    if (typeof callback === \"function\") {\n      callback();\n    }\n  };\n};\n\nsocket.on(\"bot message\", (answer) => {\n  const { msg, link } = answer;\n  botSpeak(msg);\n  if (link) {\n    window.open(link, \"_blank\");\n  }\n});"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,EAAE,EAAE;AACnB,MAAMC,iBAAiB,GACrBC,MAAM,CAACD,iBAAiB,IAAIC,MAAM,CAACC,uBAAuB;AAC5D,MAAMC,WAAW,GAAG,IAAIH,iBAAiB,EAAE;AAC3C;AACA;AACA;AACA;;AAEAG,WAAW,CAACC,IAAI,GAAG,OAAO;AAC1BD,WAAW,CAACE,cAAc,GAAG,KAAK;AAClCF,WAAW,CAACG,UAAU,GAAG,IAAI;AAC7B,IAAIC,SAAS,GAAG,KAAK;AAErB,OAAO,MAAMC,KAAK,GAAGA,CAAA,KAAM;EACzBC,QAAQ,CAAC,oBAAoB,CAAC;EAC9BN,WAAW,CAACK,KAAK,EAAE;EACnBE,MAAM,CAACC,WAAW,GAAG,gBAAgB;EACrCC,OAAO,CAACC,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;EAC/BC,UAAU,CAACF,SAAS,CAACC,GAAG,CAAC,MAAM,CAAC;AAClC,CAAC;AAED,OAAO,MAAME,IAAI,GAAGA,CAAA,KAAM;EACxBb,WAAW,CAACa,IAAI,EAAE;EAClBP,QAAQ,CAAC,yBAAyB,CAAC;EACnCC,MAAM,CAACC,WAAW,GAAG,eAAe;EACpCC,OAAO,CAACC,SAAS,CAACI,MAAM,CAAC,QAAQ,CAAC;EAClCF,UAAU,CAACF,SAAS,CAACI,MAAM,CAAC,MAAM,CAAC;AACrC,CAAC;AAEDC,WAAW,CAACC,gBAAgB,CAAC,OAAO,EAAE,MAAM;EAC1CZ,SAAS,GAAGS,IAAI,EAAE,GAAGR,KAAK,EAAE;EAC5BD,SAAS,GAAG,CAACA,SAAS;AACxB,CAAC,CAAC;AAEFJ,WAAW,CAACgB,gBAAgB,CAAC,QAAQ,EAAGC,CAAC,IAAK;EAC5C;EACA,MAAMC,IAAI,GAAGD,CAAC,CAACE,OAAO,CAACC,MAAM,GAAG,CAAC;EACjC,MAAMC,IAAI,GAAGJ,CAAC,CAACE,OAAO,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC,CAACI,UAAU;EAC1C3B,MAAM,CAAC4B,IAAI,CAAC,cAAc,EAAEF,IAAI,CAAC;AACnC,CAAC,CAAC;AAEFrB,WAAW,CAACgB,gBAAgB,CAAC,WAAW,EAAE,MAAM;EAC9CZ,SAAS,GAAGS,IAAI,EAAE,GAAG,IAAI;EACzBT,SAAS,GAAG,CAACA,SAAS;AACxB,CAAC,CAAC;AAEFJ,WAAW,CAACgB,gBAAgB,CAAC,OAAO,EAAGC,CAAC,IAAK;EAC3CO,OAAO,CAACC,GAAG,CAACR,CAAC,CAACS,KAAK,CAAC;EACpBb,IAAI,EAAE;AACR,CAAC,CAAC;;AAEF;AACA,MAAMP,QAAQ,GAAGA,CAACe,IAAI,EAAEM,QAAQ,KAAK;EACnC,MAAMC,KAAK,GAAG9B,MAAM,CAAC+B,eAAe;EACpC,MAAMC,SAAS,GAAG,IAAIC,wBAAwB,CAACV,IAAI,CAAC;EACpDO,KAAK,CAACI,KAAK,CAACF,SAAS,CAAC;EAEtBA,SAAS,CAACG,KAAK,GAAG,MAAM;IACtB,IAAI,OAAON,QAAQ,KAAK,UAAU,EAAE;MAClCA,QAAQ,EAAE;IACZ;EACF,CAAC;AACH,CAAC;AAEDhC,MAAM,CAACuC,EAAE,CAAC,aAAa,EAAGC,MAAM,IAAK;EACnC,MAAM;IAAEC,GAAG;IAAEC;EAAK,CAAC,GAAGF,MAAM;EAC5B7B,QAAQ,CAAC8B,GAAG,CAAC;EACb,IAAIC,IAAI,EAAE;IACRvC,MAAM,CAACwC,IAAI,CAACD,IAAI,EAAE,QAAQ,CAAC;EAC7B;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}