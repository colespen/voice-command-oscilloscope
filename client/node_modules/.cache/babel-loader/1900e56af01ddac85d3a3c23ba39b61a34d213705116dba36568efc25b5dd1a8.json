{"ast":null,"code":"const socket = io();\nconst SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\nconst recognition = new SpeechRecognition();\nconst startButton = document.querySelector(\"button\");\nconst microphone = document.querySelector(\".fa-microphone\");\nconst output = document.querySelector(\".output\");\nconst loading = document.querySelector(\".lds-ripple\");\nrecognition.lang = \"en-US\";\nrecognition.interimResults = false;\nrecognition.continuous = true;\nlet listening = false;\nexport const start = () => {\n  botSpeak(\"Yo! What is good?!\");\n  recognition.start();\n  output.textContent = \"Listening ... \";\n  loading.classList.add(\"reveal\");\n  microphone.classList.add(\"hide\");\n};\nexport const stop = () => {\n  recognition.stop();\n  botSpeak(\"Thanks for dropping by!\");\n  output.textContent = \"Session ended\";\n  loading.classList.remove(\"reveal\");\n  microphone.classList.remove(\"hide\");\n};\nstartButton.addEventListener(\"click\", () => {\n  listening ? stop() : start();\n  listening = !listening;\n});\nrecognition.addEventListener(\"result\", e => {\n  //console.log(e.results); // e.results :SpeechRecognitionResult object\n  const last = e.results.length - 1;\n  const text = e.results[last][0].transcript;\n  socket.emit(\"user message\", text);\n});\nrecognition.addEventListener(\"speechend\", () => {\n  listening ? stop() : null;\n  listening = !listening;\n});\nrecognition.addEventListener(\"error\", e => {\n  console.log(e.error);\n  stop();\n});\n\n// receive message from server\nconst botSpeak = (text, callback) => {\n  const synth = window.speechSynthesis;\n  const utterance = new SpeechSynthesisUtterance(text);\n  synth.speak(utterance);\n  utterance.onend = () => {\n    if (typeof callback === \"function\") {\n      callback();\n    }\n  };\n};\nsocket.on(\"bot message\", answer => {\n  const {\n    msg,\n    link\n  } = answer;\n  botSpeak(msg);\n  if (link) {\n    window.open(link, \"_blank\");\n  }\n});","map":{"version":3,"names":["socket","io","SpeechRecognition","window","webkitSpeechRecognition","recognition","startButton","document","querySelector","microphone","output","loading","lang","interimResults","continuous","listening","start","botSpeak","textContent","classList","add","stop","remove","addEventListener","e","last","results","length","text","transcript","emit","console","log","error","callback","synth","speechSynthesis","utterance","SpeechSynthesisUtterance","speak","onend","on","answer","msg","link","open"],"sources":["/Users/beluga/Documents/Dev/React/audio_visualizer/client/src/util/speechRecognition.js"],"sourcesContent":["const socket = io();\nconst SpeechRecognition =\n  window.SpeechRecognition || window.webkitSpeechRecognition;\nconst recognition = new SpeechRecognition();\nconst startButton = document.querySelector(\"button\");\nconst microphone = document.querySelector(\".fa-microphone\");\nconst output = document.querySelector(\".output\");\nconst loading = document.querySelector(\".lds-ripple\");\n\nrecognition.lang = \"en-US\";\nrecognition.interimResults = false;\nrecognition.continuous = true;\nlet listening = false;\n\nexport const start = () => {\n  botSpeak(\"Yo! What is good?!\");\n  recognition.start();\n  output.textContent = \"Listening ... \";\n  loading.classList.add(\"reveal\");\n  microphone.classList.add(\"hide\");\n};\n\nexport const stop = () => {\n  recognition.stop();\n  botSpeak(\"Thanks for dropping by!\");\n  output.textContent = \"Session ended\";\n  loading.classList.remove(\"reveal\");\n  microphone.classList.remove(\"hide\");\n};\n\nstartButton.addEventListener(\"click\", () => {\n  listening ? stop() : start();\n  listening = !listening;\n});\n\nrecognition.addEventListener(\"result\", (e) => {\n  //console.log(e.results); // e.results :SpeechRecognitionResult object\n  const last = e.results.length - 1;\n  const text = e.results[last][0].transcript;\n  socket.emit(\"user message\", text);\n});\n\nrecognition.addEventListener(\"speechend\", () => {\n  listening ? stop() : null;\n  listening = !listening;\n});\n\nrecognition.addEventListener(\"error\", (e) => {\n  console.log(e.error);\n  stop();\n});\n\n// receive message from server\nconst botSpeak = (text, callback) => {\n  const synth = window.speechSynthesis;\n  const utterance = new SpeechSynthesisUtterance(text);\n  synth.speak(utterance);\n\n  utterance.onend = () => {\n    if (typeof callback === \"function\") {\n      callback();\n    }\n  };\n};\n\nsocket.on(\"bot message\", (answer) => {\n  const { msg, link } = answer;\n  botSpeak(msg);\n  if (link) {\n    window.open(link, \"_blank\");\n  }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}