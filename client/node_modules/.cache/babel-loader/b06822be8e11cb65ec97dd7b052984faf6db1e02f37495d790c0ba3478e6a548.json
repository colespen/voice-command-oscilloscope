{"ast":null,"code":"var _jsxFileName = \"/Users/beluga/Documents/Dev/React/audio_visualizer/src/components/Visualizer2.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport \"./index.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Visualizer2 = () => {\n  _s();\n  const [stream, setStream] = useState(null);\n  const [gain, setGain] = useState(1);\n  const analyserCanvas = React.useRef(null);\n  const audioTest = async gainValue => {\n    if (navigator.mediaDevices.getUserMedia !== null) {\n      const options = {\n        video: false,\n        audio: true\n      };\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(options);\n        const audioCtx = new AudioContext();\n        const analyser = audioCtx.createAnalyser();\n        analyser.fftSize = 2048;\n        const gainNode = audioCtx.createGain(); // create a gain node\n        gainNode.gain.value = gainValue;\n        const audioSrc = audioCtx.createMediaStreamSource(stream);\n        audioSrc.connect(gainNode); // connect to the gain node\n        gainNode.connect(analyser); // connect to the analyser\n        audioSrc.connect(analyser);\n        const data = new Uint8Array(analyser.frequencyBinCount);\n        const ctx = analyserCanvas.current.getContext(\"2d\");\n        const draw = dataParm => {\n          ctx.clearRect(0, 0, analyserCanvas.current.width, analyserCanvas.current.height); // clear the canvas before drawing\n          dataParm = [...dataParm];\n          ctx.fillStyle = \"white\"; //white background\n          ctx.lineWidth = 2; //width of candle/bar\n          ctx.strokeStyle = \"green\"; //color of candle/bar\n          const space = analyserCanvas.current.width / dataParm.length;\n          dataParm.forEach((value, i) => {\n            ctx.beginPath();\n            ctx.moveTo(space * i, analyserCanvas.current.height); //x,y\n            ctx.lineTo(space * i, analyserCanvas.current.height - value); //x,y\n            ctx.stroke();\n          });\n        };\n        const loopingFunction = () => {\n          requestAnimationFrame(loopingFunction);\n          analyser.getByteFrequencyData(data);\n          draw(data);\n        };\n        requestAnimationFrame(loopingFunction);\n        setStream(stream);\n      } catch (err) {\n        // error handling\n      }\n    }\n  };\n  useEffect(() => {\n    audioTest(gain);\n  }, [gain]);\n  useEffect(() => {\n    if (stream) {\n      audioTest();\n    }\n    console.log();\n  }, [stream]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: analyserCanvas\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"gain\",\n        children: \"Gain:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"range\",\n        min: \"0\",\n        max: \"10\",\n        step: \"0.1\",\n        value: gain,\n        onChange: e => setGain(parseFloat(e.target.value)),\n        id: \"gain\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Visualizer2, \"pIAKMPYmUMHTJrZihL+W5ETPAUs=\");\n_c = Visualizer2;\nexport default Visualizer2;\nvar _c;\n$RefreshReg$(_c, \"Visualizer2\");","map":{"version":3,"names":["React","useEffect","useState","jsxDEV","_jsxDEV","Fragment","_Fragment","Visualizer2","_s","stream","setStream","gain","setGain","analyserCanvas","useRef","audioTest","gainValue","navigator","mediaDevices","getUserMedia","options","video","audio","audioCtx","AudioContext","analyser","createAnalyser","fftSize","gainNode","createGain","value","audioSrc","createMediaStreamSource","connect","data","Uint8Array","frequencyBinCount","ctx","current","getContext","draw","dataParm","clearRect","width","height","fillStyle","lineWidth","strokeStyle","space","length","forEach","i","beginPath","moveTo","lineTo","stroke","loopingFunction","requestAnimationFrame","getByteFrequencyData","err","console","log","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","type","min","max","step","onChange","e","parseFloat","target","id","_c","$RefreshReg$"],"sources":["/Users/beluga/Documents/Dev/React/audio_visualizer/src/components/Visualizer2.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport \"./index.css\";\n\nconst Visualizer2: React.FC = () => {\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  const [gain, setGain] = useState(1);\n  const analyserCanvas: any = React.useRef(null);\n\n  const audioTest = async (gainValue: number) => {\n    if (navigator.mediaDevices.getUserMedia !== null) {\n      const options = {\n        video: false,\n        audio: true,\n      };\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(options);\n        const audioCtx = new AudioContext();\n        const analyser = audioCtx.createAnalyser();\n        analyser.fftSize = 2048;\n        const gainNode = audioCtx.createGain(); // create a gain node\n        gainNode.gain.value = gainValue;\n\n        const audioSrc = audioCtx.createMediaStreamSource(stream);\n        audioSrc.connect(gainNode); // connect to the gain node\n        gainNode.connect(analyser); // connect to the analyser\n        audioSrc.connect(analyser);\n        const data = new Uint8Array(analyser.frequencyBinCount);\n        const ctx = analyserCanvas.current.getContext(\"2d\");\n\n        const draw = (dataParm: any) => {\n          ctx.clearRect(\n            0,\n            0,\n            analyserCanvas.current.width,\n            analyserCanvas.current.height\n          ); // clear the canvas before drawing\n          dataParm = [...dataParm];\n          ctx.fillStyle = \"white\"; //white background\n          ctx.lineWidth = 2; //width of candle/bar\n          ctx.strokeStyle = \"green\"; //color of candle/bar\n          const space = analyserCanvas.current.width / dataParm.length;\n\n          dataParm.forEach((value: number, i: number) => {\n            ctx.beginPath();\n            ctx.moveTo(space * i, analyserCanvas.current.height); //x,y\n            ctx.lineTo(space * i, analyserCanvas.current.height - value); //x,y\n            ctx.stroke();\n          });\n        };\n        const loopingFunction = () => {\n          requestAnimationFrame(loopingFunction);\n          analyser.getByteFrequencyData(data);\n          draw(data);\n        };\n        requestAnimationFrame(loopingFunction);\n        setStream(stream);\n      } catch (err) {\n        // error handling\n      }\n    }\n  };\n\n  useEffect(() => {\n    audioTest(gain);\n  }, [gain]);\n\n  useEffect(() => {\n    if (stream) {\n      audioTest();\n    }\n    console.log()\n  }, [stream]);\n\n  return (\n    <>\n      <canvas ref={analyserCanvas} />\n      <div>\n        <label htmlFor=\"gain\">Gain:</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"10\"\n          step=\"0.1\"\n          value={gain}\n          onChange={(e) => setGain(parseFloat(e.target.value))}\n          id=\"gain\"\n        />\n      </div>\n    </>\n  );\n};\n\nexport default Visualizer2;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAElD,OAAO,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAErB,MAAMC,WAAqB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAClC,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGR,QAAQ,CAAqB,IAAI,CAAC;EAC9D,MAAM,CAACS,IAAI,EAAEC,OAAO,CAAC,GAAGV,QAAQ,CAAC,CAAC,CAAC;EACnC,MAAMW,cAAmB,GAAGb,KAAK,CAACc,MAAM,CAAC,IAAI,CAAC;EAE9C,MAAMC,SAAS,GAAG,MAAOC,SAAiB,IAAK;IAC7C,IAAIC,SAAS,CAACC,YAAY,CAACC,YAAY,KAAK,IAAI,EAAE;MAChD,MAAMC,OAAO,GAAG;QACdC,KAAK,EAAE,KAAK;QACZC,KAAK,EAAE;MACT,CAAC;MACD,IAAI;QACF,MAAMb,MAAM,GAAG,MAAMQ,SAAS,CAACC,YAAY,CAACC,YAAY,CAACC,OAAO,CAAC;QACjE,MAAMG,QAAQ,GAAG,IAAIC,YAAY,EAAE;QACnC,MAAMC,QAAQ,GAAGF,QAAQ,CAACG,cAAc,EAAE;QAC1CD,QAAQ,CAACE,OAAO,GAAG,IAAI;QACvB,MAAMC,QAAQ,GAAGL,QAAQ,CAACM,UAAU,EAAE,CAAC,CAAC;QACxCD,QAAQ,CAACjB,IAAI,CAACmB,KAAK,GAAGd,SAAS;QAE/B,MAAMe,QAAQ,GAAGR,QAAQ,CAACS,uBAAuB,CAACvB,MAAM,CAAC;QACzDsB,QAAQ,CAACE,OAAO,CAACL,QAAQ,CAAC,CAAC,CAAC;QAC5BA,QAAQ,CAACK,OAAO,CAACR,QAAQ,CAAC,CAAC,CAAC;QAC5BM,QAAQ,CAACE,OAAO,CAACR,QAAQ,CAAC;QAC1B,MAAMS,IAAI,GAAG,IAAIC,UAAU,CAACV,QAAQ,CAACW,iBAAiB,CAAC;QACvD,MAAMC,GAAG,GAAGxB,cAAc,CAACyB,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC;QAEnD,MAAMC,IAAI,GAAIC,QAAa,IAAK;UAC9BJ,GAAG,CAACK,SAAS,CACX,CAAC,EACD,CAAC,EACD7B,cAAc,CAACyB,OAAO,CAACK,KAAK,EAC5B9B,cAAc,CAACyB,OAAO,CAACM,MAAM,CAC9B,CAAC,CAAC;UACHH,QAAQ,GAAG,CAAC,GAAGA,QAAQ,CAAC;UACxBJ,GAAG,CAACQ,SAAS,GAAG,OAAO,CAAC,CAAC;UACzBR,GAAG,CAACS,SAAS,GAAG,CAAC,CAAC,CAAC;UACnBT,GAAG,CAACU,WAAW,GAAG,OAAO,CAAC,CAAC;UAC3B,MAAMC,KAAK,GAAGnC,cAAc,CAACyB,OAAO,CAACK,KAAK,GAAGF,QAAQ,CAACQ,MAAM;UAE5DR,QAAQ,CAACS,OAAO,CAAC,CAACpB,KAAa,EAAEqB,CAAS,KAAK;YAC7Cd,GAAG,CAACe,SAAS,EAAE;YACff,GAAG,CAACgB,MAAM,CAACL,KAAK,GAAGG,CAAC,EAAEtC,cAAc,CAACyB,OAAO,CAACM,MAAM,CAAC,CAAC,CAAC;YACtDP,GAAG,CAACiB,MAAM,CAACN,KAAK,GAAGG,CAAC,EAAEtC,cAAc,CAACyB,OAAO,CAACM,MAAM,GAAGd,KAAK,CAAC,CAAC,CAAC;YAC9DO,GAAG,CAACkB,MAAM,EAAE;UACd,CAAC,CAAC;QACJ,CAAC;QACD,MAAMC,eAAe,GAAGA,CAAA,KAAM;UAC5BC,qBAAqB,CAACD,eAAe,CAAC;UACtC/B,QAAQ,CAACiC,oBAAoB,CAACxB,IAAI,CAAC;UACnCM,IAAI,CAACN,IAAI,CAAC;QACZ,CAAC;QACDuB,qBAAqB,CAACD,eAAe,CAAC;QACtC9C,SAAS,CAACD,MAAM,CAAC;MACnB,CAAC,CAAC,OAAOkD,GAAG,EAAE;QACZ;MAAA;IAEJ;EACF,CAAC;EAED1D,SAAS,CAAC,MAAM;IACdc,SAAS,CAACJ,IAAI,CAAC;EACjB,CAAC,EAAE,CAACA,IAAI,CAAC,CAAC;EAEVV,SAAS,CAAC,MAAM;IACd,IAAIQ,MAAM,EAAE;MACVM,SAAS,EAAE;IACb;IACA6C,OAAO,CAACC,GAAG,EAAE;EACf,CAAC,EAAE,CAACpD,MAAM,CAAC,CAAC;EAEZ,oBACEL,OAAA,CAAAE,SAAA;IAAAwD,QAAA,gBACE1D,OAAA;MAAQ2D,GAAG,EAAElD;IAAe;MAAAmD,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG,eAC/B/D,OAAA;MAAA0D,QAAA,gBACE1D,OAAA;QAAOgE,OAAO,EAAC,MAAM;QAAAN,QAAA,EAAC;MAAK;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAQ,eACnC/D,OAAA;QACEiE,IAAI,EAAC,OAAO;QACZC,GAAG,EAAC,GAAG;QACPC,GAAG,EAAC,IAAI;QACRC,IAAI,EAAC,KAAK;QACV1C,KAAK,EAAEnB,IAAK;QACZ8D,QAAQ,EAAGC,CAAC,IAAK9D,OAAO,CAAC+D,UAAU,CAACD,CAAC,CAACE,MAAM,CAAC9C,KAAK,CAAC,CAAE;QACrD+C,EAAE,EAAC;MAAM;QAAAb,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QACT;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACE;EAAA,gBACL;AAEP,CAAC;AAAC3D,EAAA,CAvFID,WAAqB;AAAAuE,EAAA,GAArBvE,WAAqB;AAyF3B,eAAeA,WAAW;AAAC,IAAAuE,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}